---
layout: post
title:  "使用ssh框架做的bbs论坛"
date:   2015-7-1
---
<p class="intro"><span class="dropcap">SSH</span>学习之后做的一个BBS论坛，可正向生成数据表，实现了绝大多数功能，使用的是myeclipes+oracle+apache.</p>
<p>项目共有五张表：用户表(User)，栏目表(Item)，子栏目表(SubItem)，帖子表(Topic),回复表(Reply).</P>

##login
```java

	public String login() throws Exception{
		System.out.println("login方法");
		ActionContext ac=ActionContext.getContext();
		Integer counter=(Integer) ac.getApplication().get("counter");
		if(counter==null){
			counter=1;
		}else{
			counter=counter+1;
		}
		ac.getApplication().put("counter", counter);
		if(username.equals("admin"))  throw new MyException("这是我自定义的异常");
		if(username.equals("select")||username.equals("from")||username.equals("users")){
			throw new java.sql.SQLException("用户名不能为"+username);
		}
		
		loginuser=userBiz.findAll(new User(username,password));
		ac.getSession().put("loginuser", loginuser);
		if(loginuser!=null)
			System.out.println(loginuser.toString());
		ac.getSession().put("tip", getText("successTip",new String[]{ username}));
		return "success";
	}
```
##goIndex

```java
	
	public String execute(){
		System.out.println("gonIdnex方法");
		items=itemBiz.findAllItem();
		for(Item item:items){
			subItems=subItemBiz.findAllSub(item.getItemid());
			map.put(item, subItems);
		}
		System.out.println("map"+map);
		return SUCCESS;
	}
```
##register
```java
	
	public String register() throws IOException{
		String targetDirectory=ServletActionContext.getServletContext().getRealPath("/upload");
		File dir=new File(targetDirectory);
		if(!dir.exists()){
			dir.mkdir();
		}
		File target=new File(dir,uploadFileFileName);
		FileUtils.copyFile(uploadFile, target);
		User user=new User();
		user.setUsername(username);
		user.setPassword(password);
		user.setSex(sex);
		user.setPopedom(4L);
		user.setIntegral(200L);
		user.setBirthday(birthDay);
		user.setImages(uploadFileFileName);
		ActionContext ac=ActionContext.getContext();
		String alert="用户名已存在，请输入其它用户名!";
		if(userBiz.cherlLongin(username)){
			addActionError(alert);
			return "error";
		}
		boolean flag=userBiz.addUser(user);
		if(flag){
			return "success";
		}else{
			return "error";
		}
	}
```
由于代码比较多，只简单的贴出了几个功能代码，具体项目见我的github项目[BBS](https://github.com/vienan/BBS/tree/master "BBS")